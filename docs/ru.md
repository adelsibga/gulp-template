# Gulp сборка

Сборка Gulp для верстки и разработки. [English](../README.md)

## Основные фичи

- SCSS/SASS/LESS
- TWIG
- Минимизация js, css, картинок

### Скоро

- Конвертация шрифтов в формат woff2
- Eslint
- Prettier
- Алиасы для js, images, fonts...
- Различные режимы сборок:
    - Prod
    - Dev
- Подключение различных библиотек стилей и скриптов
- Компонент картинок для ретина экранов
- Поддержка формата изображений __webp__ и __avif__ форматов
- SVG спрайты
- ```<link preload>``` в верстке для шрифтов

## Installation

Для работы с данной сборкой в новом проекте склонируйте все содержимое репозитория

```
git clone https://github.com/adelsibga/gulp-template.git
```

Затем, находясь в корне проекта, запустите команду `npm i`, которая установит все находящиеся в `package.json` зависимости. После этого
можно использовать любую из предложенных [команд](#команды) (полученные файлы помещаются в папку build в корневом каталоге)

## Структура папок и файлов

```
├── build                         # Папка с собранным проектом
├── docs                          # Папка с документацией
├── src                           # Рабочая директория
│   ├── assets                    # Папка для хранения ассетов - json, php, video files, и т.д.
│   ├── components                # Папка для хранения компонентов в формате twig
│   ├── fonts                     # Папка для хранения шрифтов
│   ├── images                    # Папка для хранения картинок
│   │   ├── favicon               # Папка для хранения favicon
│   ├── js                        # Скрипты
│   │   ├── components            # JS компоненты
│   │   ├── utils                 # Папка с утилитами
│   │   └── index.js              # Главный файл скриптов
│   ├── less                      # Стили (less синтаксис)
│   ├── sass                      # Стили (sass синтаксис)
│   ├── scss                      # Стили (scss синтаксис)
│   │   ├── components            # Паска с компонентами стилей
│   │   ├── config                # Папка с конфигурационными файлами
│   │   │   └── _fonts.scss       # Файл для подключения шрифтов
│   │   │   └── _vars.scss        # Файл констант
│   │   ├── mixins                # Папка с миксинами
│   │   │   └── fontFace.scss     # Миксин для шрифтов
│   │   └── index.scss            # Главный файл стилей
│   ├── templates                 # Папка для хранения шаблонов twig файлов
│   │   └── layout.twig           # Файл с шаблоном
│   └── index.twig                # Главный twig файл
└── .gitignore                    # Файл .gitignore нужен, чтобы скрыть файлы и папки от системы контроля версий Git
└── gulpfile.js                   # Файл настроек Gulp
└── package.json                  # Файл с настройками сборки и установленными пакетами
└── package-lock.json             # Файл package-lock.json используется для фиксации зависимостей к определенному номеру версии
└── README.md                     # Документация по сборке
```

## Оглавление

1. [npm-скрипты](#npm-скрипты)
2. [Команды](#команды)
3. [Работа с Twig](#работа-с-twig)
4. [Работа со стилями](#работа-со-стилями)
5. [Работа с JS](#работа-с-JS)
6. [Работа со шрифтами](#работа-со-шрифтами)
7. [Работа с изображениями](#работа-с-изображениями)
8. [Работа с иными ресурсами](#работа-с-иными-ресурсами)
9. [Заключегие](#заключение)

## npm-скрипты

TODO: добавить и написать инструкцию для eslint, prettier

## Команды

1. `gulp twig2Html` - собирает twig в html
2. `gulp styles` - собирает стили
3. `gulp scripts` - собирает js скрипты
4. `gulp images` - сжимает и оптимизирует картинки
5. `gulp fonts` - перегоняет шрифты в build директорию
6. `gulp assets` - перегоняет все файлы из assets в build директорию
7. `gulp clean` - очищает build директорию
8. `gulp build` - выполняет все таски описанные выше
9. `gulp` - запускает таск `gulp build`, поднимает browserSync и автоматически перезагружает браузер

## Работа с Twig

Благоддаря плагину gulp-twig вы можете разделять верстку на различные части, шаблоны, компоненты, которые должны хранитсья в папке components.
Удобно делить страницу на секции.
> Для вставки частей в файлы используйте `{% include './components/filename.twig' %}`.

> Для использования шаблонов страниц в новом twig файле используйте `{% extends 'templates/layout.twig' %}`.

Более подробно про twig можно прочитать в [документации](https://twig.symfony.com/doc/3.x/).

## Работа со стилями

В сборке используются препроцессоры: __less__ и __sass__ в синтаксисе __scss__ и __sass__.
Смена препроцессора происходит в файле ```gulpfile.js```.
Чтобы использовать синтаксис __scss__, нужно заменить значение переменной ```preprocessor``` на __scss__ ```let preprocessor = 'scss'```.

TODO: Чтобы подключить сторонние css-файлы (библиотеки) - положите их в папку __vendor__ и подключите в файле ```_vendor.scss```.

Если вы хотите создать свой миксин - делайте это в папке __mixins__, а затем подключайте в файл ```_.scss```.

Стили, написанные в __components__, следует подключать в __index.scss__.

При использовании команды `gulp build`, вы получите минифицированный css-код в одну строку для всех css-файлов.

## Работа с JS

TODO: Подключать сторонние библиотеки можно через npm, для этого существует файл ```vendor.js```. Импортируйте туда подключения.

При использовании команды `gulp build`, вы получите минифицированный js-код в одну строку для всех js-файлов.

## Работа со шрифтами

Для упрощения подключения шрифтов используйте миксин, который находится в `fontFace.scss`.

```scss
@include font-face('Euclid Circular B Bold', '../fonts/EuclidCircularB-Bold', bold, normal, false);
```

> Первый параметр ```$font-family``` - служит для определения семейства шрифтов.

> Второй параметр ```$url``` - путь до файла шрифта.

> Третий параметр ```$weight``` - отвечает за жирность шрифта.

> Четвертый параметр ```$style``` - отвечает за стиль шрифта.

> Последний параметр ```$onlyWoff2``` не обязательный и служит для выбора формата/ов шрифтов: только __woff2__
> или сразу четырех __embedded-opentype__, __truetype__, __woff__ и  __woff2__.
> По умолчанию __false__.

Загружайте файлы шрифтов в папку `fonts`, а затем вызывайте миксин `@font-face` из `fontFace.scss`.
TODO: Также не забудьте прописать эти же шрифты в ```<link preload>``` в верстке. https://habr.com/ru/articles/445264/

## Работа с изображениями

Все изображения хранятся в папке images.
При использовании команды gulp build, вы получите минифицированные изображения в итоговой папке img.

TODO: Для retina экранов будет добавлен img компонент,
который будет заменять изображение на изображение с более высоким качеством
Описать работу компонента

TODO: Добавить поддержку картинков в формате __webp__ и __avif__ форматов
TODO: Добавить конвертацию картинок из любых форматов в формат/ты __webp__ и __avif__
TODO: Добавить svg спрайты

## Работа с иными ресурсами

Любые ресурсы (ассеты) проекта, под которые не отведена соответствующая папка, должны храниться в папке __assets__. Это могут быть видео-файлы,
php-файлы (как, например, файл отправки формы), favicon и прочие.

## Заключение

Спасибо всем, кто использует сборку! Если вы заметили какую-либо ошибку, пришлите пожалуйста issue с подробным описанием проблемы, я все смотрю и
постараюсь решить. Спасибо!